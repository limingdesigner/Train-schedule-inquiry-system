\# 火车班次查询系统

\# 火车班次查询系统



一个基于Python和SQLite的火车班次信息管理和查询系统，提供车次录入、查询、搜索、查看和删除等功能。



\## 📋 目录



\- \[功能特性](#功能特性)

\- \[系统要求](#系统要求)

\- \[安装说明](#安装说明)

\- \[使用指南](#使用指南)

\- \[数据库结构](#数据库结构)

\- \[功能详解](#功能详解)

\- \[使用示例](#使用示例)

\- \[注意事项](#注意事项)

\- \[技术特点](#技术特点)



\## ✨ 功能特性



\- \*\*车次信息管理\*\*：添加新车次及其沿途停靠站信息

\- \*\*智能查询\*\*：支持按出发站和到达站查询符合条件的车次

\- \*\*详细搜索\*\*：通过车次号查看完整的运行时刻表和统计信息

\- \*\*用时计算\*\*：自动计算区间运行时间和全程用时（支持跨天）

\- \*\*数据展示\*\*：查看系统中所有车次的完整信息

\- \*\*安全删除\*\*：带确认提示的车次删除功能



\## 💻 系统要求



\- Python 3.6 或更高版本

\- SQLite3（Python标准库自带）

\- datetime模块（Python标准库自带）



\## 📦 安装说明



1\. \*\*下载项目文件\*\*

```bash

\# 克隆项目或直接下载源代码文件

git clone <项目地址>

\# 或直接保存代码为 train\_system.py

```



2\. \*\*确认Python环境\*\*

```bash

python --version  # 确保Python版本 >= 3.6

```



3\. \*\*运行程序\*\*

```bash

python train\_system.py

```



程序将自动创建数据库文件 `trains.db`（首次运行时）。



\## 📖 使用指南



\### 主菜单选项



```

========== 火车班次查询系统 ==========

1\. 添加车次信息

2\. 查询车次（按站点）

3\. 搜索车次（按车次号）

4\. 查看所有车次

5\. 删除车次

6\. 退出系统

```



\### 快速开始



1\. \*\*首次使用\*\*：选择 `1` 添加车次信息

2\. \*\*查询车次\*\*：选择 `2` 输入出发站和到达站

3\. \*\*查看详情\*\*：选择 `3` 输入车次号查看详细信息



\## 🗄️ 数据库结构



\### trains 表（车次表）

| 字段 | 类型 | 说明 | 约束 |

|------|------|------|------|

| id | INTEGER | 主键 | PRIMARY KEY, AUTOINCREMENT |

| train\_no | TEXT | 车次号 | NOT NULL, UNIQUE |

| train\_type | TEXT | 列车型号 | NOT NULL |



\### stops 表（停靠站表）

| 字段 | 类型 | 说明 | 约束 |

|------|------|------|------|

| id | INTEGER | 主键 | PRIMARY KEY, AUTOINCREMENT |

| train\_id | INTEGER | 关联车次ID | FOREIGN KEY, NOT NULL |

| station\_name | TEXT | 站名 | NOT NULL |

| departure\_time | TEXT | 出发时间 | 格式: HH:MM |

| stop\_duration | INTEGER | 停靠时长(分钟) | DEFAULT 0, CHECK >= 0 |

| station\_order | INTEGER | 站序 | NOT NULL, CHECK > 0 |



\### 数据库约束

\- 车次号唯一性约束

\- 同一车次内站名唯一

\- 同一车次内站序唯一

\- 级联删除（删除车次时自动删除相关站点）



\## 🔧 功能详解



\### 1. 添加车次信息

\- 输入车次号和列车型号

\- 按顺序添加沿途停靠站

\- 每个站点需要输入：站名、出发时间、停靠时长

\- 空站名结束录入



\### 2. 查询车次（按站点）

\- 输入出发站和到达站

\- 显示所有符合条件的直达车次

\- 自动计算运行用时

\- 结果按出发时间排序



\### 3. 搜索车次（按车次号）

\- 输入车次号查看详细信息

\- 显示内容包括：

&nbsp; - 基本信息（车次号、型号、站点数）

&nbsp; - 全程用时

&nbsp; - 完整时刻表

&nbsp; - 区间运行时间

&nbsp; - 停靠统计信息



\### 4. 查看所有车次

\- 列出系统中所有车次信息

\- 按车次号分组显示

\- 显示每个车次的全程用时



\### 5. 删除车次

\- 输入车次号删除

\- 显示将删除的站点数量

\- 需要确认操作

\- 自动清理关联数据



\## 📝 使用示例



\### 示例1：添加车次

```

请选择操作: 1

输入车次号: G1234

输入列车型号: 高速动车

第1站名称: 北京南

出发时间 (HH:MM): 08:00

停靠分钟数: 0

第2站名称: 济南西

出发时间 (HH:MM): 09:30

停靠分钟数: 2

第3站名称: 南京南

出发时间 (HH:MM): 11:45

停靠分钟数: 3

第4站名称: 上海虹桥

出发时间 (HH:MM): 12:50

停靠分钟数: 0

第5站名称: \[空回车结束]

```



\### 示例2：查询车次

```

请选择操作: 2

输入出发站: 北京南

输入到达站: 上海虹桥



符合条件的车次：

车次      型号      出发时间        到达时间        用时

G1234     高速动车   08:00          12:50          4小时50分钟

```



\### 示例3：搜索车次详情

```

请选择操作: 3

请输入要搜索的车次号: G1234



车次详细信息

车次号: G1234

列车型号: 高速动车

途经站点数: 4

全程用时: 4小时50分钟

始发站: 北京南 (08:00)

终点站: 上海虹桥 (12:50)



沿途停靠站点：

序号   站名           到达/出发时间   停靠时间    区间用时

1      北京南         08:00          ---         始发站

2      济南西         09:30          2分钟       1小时30分钟

3      南京南         11:45          3分钟       2小时15分钟

4      上海虹桥       12:50          ---         1小时5分钟



总停靠时间: 5 分钟

平均停站时间: 2.5 分钟（不含始发和终点站）

```



\## ⚠️ 注意事项



1\. \*\*时间格式\*\*：请使用24小时制，格式为 HH:MM（如 09:30, 15:45）

2\. \*\*跨天运行\*\*：系统自动识别跨天情况（如23:50出发，01:20到达）

3\. \*\*数据完整性\*\*：

&nbsp;  - 车次号必须唯一

&nbsp;  - 同一车次中站名不能重复

&nbsp;  - 至少需要2个站点（始发站和终点站）

4\. \*\*数据库文件\*\*：`trains.db` 文件保存所有数据，请勿随意删除

5\. \*\*删除操作\*\*：删除车次会同时删除所有相关站点信息，请谨慎操作



\## 🛠️ 技术特点



\### 数据库设计

\- 使用SQLite轻量级数据库

\- 规范化设计，分离车次和站点信息

\- 完整的约束和索引优化查询性能



\### 数据完整性

\- 外键约束确保引用完整性

\- 唯一性约束防止重复数据

\- CHECK约束验证数据有效性

\- 触发器实现级联删除



\### 代码特性

\- 模块化函数设计

\- 完善的异常处理

\- 用户友好的交互界面

\- 清晰的代码注释



\### 性能优化

\- 索引优化查询速度

\- 批量操作减少数据库访问

\- 连接管理避免资源泄露



\## 📊 系统限制



\- 单机本地数据库，不支持网络访问

\- 时间仅支持HH:MM格式，不包含日期

\- 不支持中转查询，仅显示直达车次

\- 不支持座位和票价管理



\## 🔄 版本信息



\- 版本：1.0.0

\- 最后更新：2024

\- Python最低版本：3.6

\- 数据库：SQLite3



\## 📄 许可证



本项目仅供学习和参考使用。



---



\*\*提示\*\*：如遇到问题，请检查Python版本和输入格式是否正确。数据库文件`trains.db`会在首次运行时自动创建。

一个基于Python和SQLite的火车班次信息管理和查询系统，提供车次录入、查询、搜索、查看和删除等功能。



\## 📋 目录



\- \[功能特性](#功能特性)

\- \[系统要求](#系统要求)

\- \[安装说明](#安装说明)

\- \[使用指南](#使用指南)

\- \[数据库结构](#数据库结构)

\- \[功能详解](#功能详解)

\- \[使用示例](#使用示例)

\- \[注意事项](#注意事项)

\- \[技术特点](#技术特点)



\## ✨ 功能特性



\- \*\*车次信息管理\*\*：添加新车次及其沿途停靠站信息

\- \*\*智能查询\*\*：支持按出发站和到达站查询符合条件的车次

\- \*\*详细搜索\*\*：通过车次号查看完整的运行时刻表和统计信息

\- \*\*用时计算\*\*：自动计算区间运行时间和全程用时（支持跨天）

\- \*\*数据展示\*\*：查看系统中所有车次的完整信息

\- \*\*安全删除\*\*：带确认提示的车次删除功能



\## 💻 系统要求



\- Python 3.6 或更高版本

\- SQLite3（Python标准库自带）

\- datetime模块（Python标准库自带）



\## 📦 安装说明



1\. \*\*下载项目文件\*\*

```bash

\# 克隆项目或直接下载源代码文件

git clone <项目地址>

\# 或直接保存代码为 train\_system.py

```



2\. \*\*确认Python环境\*\*

```bash

python --version  # 确保Python版本 >= 3.6

```



3\. \*\*运行程序\*\*

```bash

python train\_system.py

```



程序将自动创建数据库文件 `trains.db`（首次运行时）。



\## 📖 使用指南



\### 主菜单选项



```

========== 火车班次查询系统 ==========

1\. 添加车次信息

2\. 查询车次（按站点）

3\. 搜索车次（按车次号）

4\. 查看所有车次

5\. 删除车次

6\. 退出系统

```



\### 快速开始



1\. \*\*首次使用\*\*：选择 `1` 添加车次信息

2\. \*\*查询车次\*\*：选择 `2` 输入出发站和到达站

3\. \*\*查看详情\*\*：选择 `3` 输入车次号查看详细信息



\## 🗄️ 数据库结构



\### trains 表（车次表）

| 字段 | 类型 | 说明 | 约束 |

|------|------|------|------|

| id | INTEGER | 主键 | PRIMARY KEY, AUTOINCREMENT |

| train\_no | TEXT | 车次号 | NOT NULL, UNIQUE |

| train\_type | TEXT | 列车型号 | NOT NULL |



\### stops 表（停靠站表）

| 字段 | 类型 | 说明 | 约束 |

|------|------|------|------|

| id | INTEGER | 主键 | PRIMARY KEY, AUTOINCREMENT |

| train\_id | INTEGER | 关联车次ID | FOREIGN KEY, NOT NULL |

| station\_name | TEXT | 站名 | NOT NULL |

| departure\_time | TEXT | 出发时间 | 格式: HH:MM |

| stop\_duration | INTEGER | 停靠时长(分钟) | DEFAULT 0, CHECK >= 0 |

| station\_order | INTEGER | 站序 | NOT NULL, CHECK > 0 |



\### 数据库约束

\- 车次号唯一性约束

\- 同一车次内站名唯一

\- 同一车次内站序唯一

\- 级联删除（删除车次时自动删除相关站点）



\## 🔧 功能详解



\### 1. 添加车次信息

\- 输入车次号和列车型号

\- 按顺序添加沿途停靠站

\- 每个站点需要输入：站名、出发时间、停靠时长

\- 空站名结束录入



\### 2. 查询车次（按站点）

\- 输入出发站和到达站

\- 显示所有符合条件的直达车次

\- 自动计算运行用时

\- 结果按出发时间排序



\### 3. 搜索车次（按车次号）

\- 输入车次号查看详细信息

\- 显示内容包括：

&nbsp; - 基本信息（车次号、型号、站点数）

&nbsp; - 全程用时

&nbsp; - 完整时刻表

&nbsp; - 区间运行时间

&nbsp; - 停靠统计信息



\### 4. 查看所有车次

\- 列出系统中所有车次信息

\- 按车次号分组显示

\- 显示每个车次的全程用时



\### 5. 删除车次

\- 输入车次号删除

\- 显示将删除的站点数量

\- 需要确认操作

\- 自动清理关联数据



\## 📝 使用示例



\### 示例1：添加车次

```

请选择操作: 1

输入车次号: G1234

输入列车型号: 高速动车

第1站名称: 北京南

出发时间 (HH:MM): 08:00

停靠分钟数: 0

第2站名称: 济南西

出发时间 (HH:MM): 09:30

停靠分钟数: 2

第3站名称: 南京南

出发时间 (HH:MM): 11:45

停靠分钟数: 3

第4站名称: 上海虹桥

出发时间 (HH:MM): 12:50

停靠分钟数: 0

第5站名称: \[空回车结束]

```



\### 示例2：查询车次

```

请选择操作: 2

输入出发站: 北京南

输入到达站: 上海虹桥



符合条件的车次：

车次      型号      出发时间        到达时间        用时

G1234     高速动车   08:00          12:50          4小时50分钟

```



\### 示例3：搜索车次详情

```

请选择操作: 3

请输入要搜索的车次号: G1234



车次详细信息

车次号: G1234

列车型号: 高速动车

途经站点数: 4

全程用时: 4小时50分钟

始发站: 北京南 (08:00)

终点站: 上海虹桥 (12:50)



沿途停靠站点：

序号   站名           到达/出发时间   停靠时间    区间用时

1      北京南         08:00          ---         始发站

2      济南西         09:30          2分钟       1小时30分钟

3      南京南         11:45          3分钟       2小时15分钟

4      上海虹桥       12:50          ---         1小时5分钟



总停靠时间: 5 分钟

平均停站时间: 2.5 分钟（不含始发和终点站）

```



\## ⚠️ 注意事项



1\. \*\*时间格式\*\*：请使用24小时制，格式为 HH:MM（如 09:30, 15:45）

2\. \*\*跨天运行\*\*：系统自动识别跨天情况（如23:50出发，01:20到达）

3\. \*\*数据完整性\*\*：

&nbsp;  - 车次号必须唯一

&nbsp;  - 同一车次中站名不能重复

&nbsp;  - 至少需要2个站点（始发站和终点站）

4\. \*\*数据库文件\*\*：`trains.db` 文件保存所有数据，请勿随意删除

5\. \*\*删除操作\*\*：删除车次会同时删除所有相关站点信息，请谨慎操作



\## 🛠️ 技术特点



\### 数据库设计

\- 使用SQLite轻量级数据库

\- 规范化设计，分离车次和站点信息

\- 完整的约束和索引优化查询性能



\### 数据完整性

\- 外键约束确保引用完整性

\- 唯一性约束防止重复数据

\- CHECK约束验证数据有效性

\- 触发器实现级联删除



\### 代码特性

\- 模块化函数设计

\- 完善的异常处理

\- 用户友好的交互界面

\- 清晰的代码注释



\### 性能优化

\- 索引优化查询速度

\- 批量操作减少数据库访问

\- 连接管理避免资源泄露



\## 📊 系统限制



\- 单机本地数据库，不支持网络访问

\- 时间仅支持HH:MM格式，不包含日期

\- 不支持中转查询，仅显示直达车次

\- 不支持座位和票价管理



\## 🔄 版本信息



\- 版本：1.0.0

\- 最后更新：2024

\- Python最低版本：3.6

\- 数据库：SQLite3



\## 📄 许可证



本项目仅供学习和参考使用。



---



\*\*提示\*\*：如遇到问题，请检查Python版本和输入格式是否正确。数据库文件`trains.db`会在首次运行时自动创建。

